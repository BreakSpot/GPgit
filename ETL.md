## ETL设计详解

ETL的设计分为三部分：数据抽取、数据清洗转换、数据的加载。

数据抽取：从各个不同的数据源抽取到ODS中，在抽取的过程中需要挑选不同的抽取方法，尽可能的提高ETL的运行效率。

数据清洗转换：花费时间最长，占这部分工作量的2/3

数据加载：一般在数据清洗完成后直接写入DW中去。

### 实现方法：

- ETL工具（Oracle的OWB、SQL Server 2000的DTS、SQL Server2005的SSIS服务、Informatic等）
- SQL方式
- ETL工具+SQL结合

借助工具快速建立ETL工程，屏蔽复杂的编码任务，提高速度，降低难度，缺少灵活性;

SQL方法灵活，提高ETL运行效率，但是编码复杂，对技术要求比较高；

第三中结合前两种的优点

### 一、数据的抽取（Extract）

首先搞清楚数据从几个业务系统中来，各个业务系统的数据库服务器运行什么DBMS，是否存在手工数据，手工数据量有多大，是否存在非结构化的数据等等，当收集完这些信息之后才可以进行数据抽取的设计。

**1、对于与存放DW的数据库系统相同的数据源处理方法**

这一类数据源在设计上比较容易。一般情况下，DBMS(SQLServer、Oracle)都会提供数据库链接功能，在DW数据库服务器和原业务系统之间建立直接的链接关系就可以写Select 语句直接访问。

**2、对于与DW数据库系统不同的数据源的处理方法**

对于这一类数据源，一般情况下也可以通过ODBC的方式建立数据库链接——如SQL Server和Oracle之间。如果不能建立数据库链接，可以有两种方式完成，一种是通过工具将源数据导出成.txt或者是.xls文件，然后再将这些源系统文件导入到ODS中。另外一种方法是通过程序接口来完成。

**3、对于文件系统数据源**

可以培训业务人员利用数据库工具将这些数据导入到指定的数据库，然后从指定的数据库中抽取。或者还可以借助工具实现。

**4、增量更新的问题**

对于数据量大的系统，必须考虑增量抽取。一般情况下，业务系统会记录业务发生的时间，我们可以用来做增量的标志,每次抽取之前首先判断ODS中记录最大的时间，然后根据这个时间去业务系统取大于这个时间所有的记录。利用业务系统的时间戳，一般情况下，业务系统没有或者部分有时间戳。

### 二、数据的清洗转换

从业务系统到ODS做清洗，将脏数据和不完整的数据过滤掉，在从ODS到DW的过程中转换，进行一些业务规则的计算和聚合

**1、数据清洗**

主要任务是过滤那些不符合要求的数据，将过滤的结果交给业务主管部门，确认是否过滤掉还是有业务单位修正之后在进行抽取。

不符合要求的数据主要是不完整的数据、错误的数据、重复的数据

（1）不完整的数据

（2）错误的数据

（3）重复的数据

